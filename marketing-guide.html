<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Elker Marketing Strategy Builder</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            line-height: 1.6;
            color: #2c3e50;
            background: #f5f7f6;
            min-height: 100vh;
            padding: 30px 20px;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            background: white;
            border-radius: 2px;
            overflow: hidden;
            border: 1px solid #e8ebe9;
        }

        header {
            background: #2d5f4f;
            color: white;
            padding: 50px 40px 40px;
            border-bottom: 3px solid #1e4436;
        }

        header h1 {
            font-size: 2em;
            margin-bottom: 12px;
            font-weight: 400;
            letter-spacing: -0.5px;
            font-family: Georgia, serif;
        }

        header p {
            font-size: 1em;
            opacity: 0.9;
            font-weight: 300;
        }

        .explainer {
            background: #f9faf9;
            border-bottom: 1px solid #e8ebe9;
            padding: 30px 40px;
        }

        .explainer h2 {
            font-size: 1.2em;
            color: #2d5f4f;
            margin-bottom: 15px;
            font-weight: 500;
            font-family: Georgia, serif;
        }

        .explainer p {
            color: #5a6c62;
            line-height: 1.6;
            margin-bottom: 0;
        }

        .content {
            padding: 40px 40px;
        }

        .step {
            display: none;
        }

        .step.active {
            display: block;
        }

        .progress-bar {
            width: 100%;
            height: 3px;
            background: #e8ebe9;
            margin-bottom: 40px;
        }

        .progress-fill {
            height: 100%;
            background: #3d7a62;
            transition: width 0.3s ease;
        }

        .question {
            font-size: 1.4em;
            color: #2d5f4f;
            margin-bottom: 15px;
            font-weight: 400;
            line-height: 1.4;
            font-family: Georgia, serif;
        }

        .helper-text {
            color: #5a6c62;
            margin-bottom: 25px;
            font-size: 0.95em;
            line-height: 1.6;
        }

        .example-box {
            background: #f5f8f6;
            border: 1px solid #d4e0d8;
            padding: 18px 50px 18px 20px;
            margin-bottom: 20px;
            font-size: 0.9em;
            color: #5a6c62;
            position: relative;
            font-family: 'Courier New', monospace;
        }

        .example-box strong {
            color: #2d5f4f;
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            font-size: 0.85em;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
        }

        .copy-btn {
            position: absolute;
            top: 12px;
            right: 12px;
            background: #3d7a62;
            color: white;
            border: none;
            padding: 6px 14px;
            font-size: 0.8em;
            cursor: pointer;
            border-radius: 3px;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            transition: background 0.2s ease;
        }

        .copy-btn:hover {
            background: #2d5f4f;
        }

        .options {
            display: flex;
            flex-direction: column;
            gap: 12px;
            margin-bottom: 30px;
        }

        .option-card {
            padding: 20px;
            background: white;
            border: 1px solid #d4e0d8;
            border-radius: 4px;
            cursor: pointer;
            transition: all 0.2s ease;
            position: relative;
        }

        .option-card:hover {
            border-color: #3d7a62;
            background: #f9faf9;
        }

        .option-card.selected {
            border-color: #3d7a62;
            background: #f5f8f6;
            border-width: 2px;
            padding: 19px;
        }

        .option-card.selected::after {
            content: "";
            position: absolute;
            right: 20px;
            top: 50%;
            transform: translateY(-50%);
            width: 20px;
            height: 20px;
            border: 2px solid #3d7a62;
            border-radius: 50%;
            background: #3d7a62;
        }

        .option-card.selected::before {
            content: "";
            position: absolute;
            right: 28px;
            top: 48%;
            transform: translateY(-48%) rotate(45deg);
            width: 5px;
            height: 10px;
            border: solid white;
            border-width: 0 2px 2px 0;
            z-index: 1;
        }

        .option-card h4 {
            font-size: 1.05em;
            margin-bottom: 6px;
            color: #2c3e50;
            font-weight: 500;
            font-family: Georgia, serif;
        }

        .option-card p {
            font-size: 0.9em;
            color: #5a6c62;
            margin: 0;
            line-height: 1.5;
        }

        .text-input {
            width: 100%;
            padding: 15px;
            border: 1px solid #d4e0d8;
            border-radius: 4px;
            font-size: 1em;
            font-family: inherit;
            margin-bottom: 20px;
            transition: border-color 0.2s ease;
        }

        .text-input:focus {
            outline: none;
            border-color: #3d7a62;
        }

        textarea.text-input {
            min-height: 120px;
            resize: vertical;
        }

        .button-group {
            display: flex;
            gap: 15px;
            margin-top: 30px;
        }

        .btn {
            padding: 14px 28px;
            border: none;
            border-radius: 4px;
            font-size: 1em;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .btn-primary {
            background: #3d7a62;
            color: white;
            flex: 1;
        }

        .btn-primary:hover:not(:disabled) {
            background: #2d5f4f;
        }

        .btn-primary:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .btn-secondary {
            background: white;
            color: #3d7a62;
            border: 1px solid #3d7a62;
        }

        .btn-secondary:hover {
            background: #f9faf9;
        }

        .checkbox-option {
            display: flex;
            align-items: flex-start;
            padding: 15px;
            background: white;
            border: 1px solid #d4e0d8;
            border-radius: 4px;
            cursor: pointer;
            transition: all 0.2s ease;
            margin-bottom: 10px;
        }

        .checkbox-option:hover {
            border-color: #3d7a62;
            background: #f9faf9;
        }

        .checkbox-option.selected {
            border-color: #3d7a62;
            background: #f5f8f6;
            border-width: 2px;
            padding: 14px;
        }

        .checkbox-option input[type="checkbox"] {
            width: 20px;
            height: 20px;
            margin-right: 15px;
            margin-top: 2px;
            cursor: pointer;
            flex-shrink: 0;
            accent-color: #3d7a62;
        }

        .checkbox-option .label-content {
            cursor: pointer;
            flex: 1;
        }

        .checkbox-option .label-content strong {
            display: block;
            margin-bottom: 4px;
            color: #2c3e50;
            font-weight: 500;
            font-family: Georgia, serif;
        }

        .checkbox-option .label-content span {
            font-size: 0.9em;
            color: #5a6c62;
        }

        .loading {
            display: none;
            text-align: center;
            padding: 60px 20px;
        }

        .loading.active {
            display: block;
        }

        .spinner {
            border: 3px solid #e8ebe9;
            border-top: 3px solid #3d7a62;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            animation: spin 1s linear infinite;
            margin: 0 auto 20px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .results {
            display: none;
        }

        .results.active {
            display: block;
        }

        .results h2 {
            color: #2d5f4f;
            font-size: 1.8em;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid #d4e0d8;
            font-family: Georgia, serif;
            font-weight: 400;
        }

        .recommendation-box {
            background: #f9faf9;
            padding: 25px;
            border-radius: 4px;
            margin-bottom: 25px;
            border: 1px solid #d4e0d8;
            position: relative;
        }

        .recommendation-box .copy-btn {
            top: 20px;
            right: 20px;
        }

        .recommendation-box h3 {
            color: #2d5f4f;
            font-size: 1.3em;
            margin-bottom: 15px;
            font-family: Georgia, serif;
            font-weight: 500;
            padding-right: 80px;
        }

        .recommendation-box ul {
            list-style: none;
            padding: 0;
        }

        .recommendation-box li {
            padding: 10px 0;
            padding-left: 25px;
            position: relative;
            border-bottom: 1px solid #e8ebe9;
        }

        .recommendation-box li:last-child {
            border-bottom: none;
        }

        .recommendation-box li::before {
            content: "→";
            position: absolute;
            left: 0;
            color: #3d7a62;
            font-weight: normal;
        }

        .metric-badge {
            display: inline-block;
            background: #f5f8f6;
            color: #2d5f4f;
            padding: 8px 15px;
            border-radius: 4px;
            font-weight: 500;
            margin: 10px 5px 10px 0;
            border: 1px solid #d4e0d8;
        }

        .priority-high {
            background: #e8f5f0;
            color: #1e4436;
            border-color: #3d7a62;
        }

        .priority-medium {
            background: #f5f8f6;
            color: #2d5f4f;
            border-color: #d4e0d8;
        }

        .priority-low {
            background: #f9faf9;
            color: #5a6c62;
            border-color: #e8ebe9;
        }

        .ai-content {
            background: white;
            padding: 20px;
            border-radius: 4px;
            margin: 15px 0;
            line-height: 1.9;
            border: 1px solid #d4e0d8;
            position: relative;
            white-space: pre-wrap;
        }

        .ai-content .copy-btn {
            top: 15px;
            right: 15px;
        }

        .ai-content p {
            margin-bottom: 20px;
            padding-right: 80px;
        }

        .ai-content strong {
            color: #2d5f4f;
            display: block;
            margin-bottom: 12px;
        }

        .recommendation-box p {
            margin-bottom: 18px;
            line-height: 1.7;
        }

        .recommendation-box > p:last-of-type {
            margin-bottom: 0;
        }

        .accordion-section {
            border: 1px solid #d4e0d8;
            border-radius: 4px;
            margin-bottom: 15px;
            background: white;
            overflow: hidden;
        }

        .accordion-header {
            background: #f5f8f6;
            padding: 20px 25px;
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px solid #d4e0d8;
            transition: background 0.2s;
        }

        .accordion-header:hover {
            background: #edf2ed;
        }

        .accordion-header h3 {
            margin: 0;
            color: #2d5f4f;
            font-size: 1.3em;
            font-family: Georgia, serif;
            font-weight: 500;
        }

        .accordion-icon {
            color: #3d7a62;
            font-size: 1.2em;
            transition: transform 0.3s;
            font-weight: bold;
        }

        .accordion-section.collapsed .accordion-icon {
            transform: rotate(-90deg);
        }

        .accordion-content {
            padding: 25px;
            display: block;
        }

        .accordion-section.collapsed .accordion-content {
            display: none;
        }

        .export-buttons {
            display: flex;
            gap: 10px;
            margin-top: 30px;
            padding-top: 30px;
            border-top: 1px solid #e8ebe9;
        }

        .tip-box {
            background: #f9faf9;
            border: 1px solid #d4e0d8;
            padding: 15px;
            margin: 20px 0;
            border-radius: 4px;
            font-size: 0.95em;
        }

        .tip-box strong {
            color: #2d5f4f;
            display: block;
            margin-bottom: 5px;
            text-transform: uppercase;
            font-size: 0.85em;
            letter-spacing: 0.5px;
        }

        @media (max-width: 768px) {
            .button-group {
                flex-direction: column;
            }

            .btn-secondary {
                order: 2;
            }

            header h1 {
                font-size: 1.6em;
            }

            .question {
                font-size: 1.3em;
            }

            .copy-btn {
                position: static;
                display: block;
                width: 100%;
                margin-top: 10px;
            }

            .example-box {
                padding-right: 20px;
            }

            .recommendation-box h3,
            .ai-content p {
                padding-right: 0;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>Elker Marketing Strategy Builder</h1>
            <p>Create a tailored marketing strategy for your webinar or event</p>
        </header>

        <div class="explainer">
            <h2>How this works</h2>
            <p>This tool helps you create a tailored marketing strategy for Elker webinars and events. Answer 6 questions about your event, audience, and resources, and receive a complete marketing plan with messaging, channel recommendations, and timelines.</p>
        </div>

        <div class="content">
            <div class="progress-bar">
                <div class="progress-fill" id="progressBar" style="width: 0%"></div>
            </div>

            <!-- Step 1: What's the topic/content? -->
            <div class="step active" data-step="1">
                <div class="question">What's your webinar or event about?</div>
                <div class="helper-text">
                    Tell us the topic, theme, or main focus. Describe it in your own words.
                </div>
                <div class="example-box">
                    <strong>Example:</strong>
                    "Managing workplace investigations and staying compliant with new legislation"
                    <button class="copy-btn" onclick="copyExample(this)">Copy</button>
                </div>
                <textarea class="text-input" id="topic" placeholder="Type your topic here..."></textarea>

                <div class="helper-text" style="margin-top: 20px;">
                    Who else is involved? (Partners, co-hosts, guest speakers)
                </div>
                <div class="example-box">
                    <strong>Example:</strong>
                    "We're partnering with Hall & Wilcox (law firm) and EML (insurance)"
                    <button class="copy-btn" onclick="copyExample(this)">Copy</button>
                </div>
                <textarea class="text-input" id="partners" placeholder="List any partners or leave blank if none..."></textarea>

                <div class="tip-box" style="margin-top: 25px;">
                    <strong>Need help?</strong>
                    We can help you brainstorm ideas based on your company and goals.
                </div>

                <div class="button-group">
                    <button class="btn btn-secondary" onclick="helpWithTopic()">Help me think of a topic</button>
                    <button class="btn btn-primary" onclick="nextStep()">Next</button>
                </div>
            </div>

            <!-- Topic Ideation Steps -->
            <div class="step" data-step="topic-1">
                <div class="question">What business goal are you trying to achieve?</div>
                <div class="helper-text">
                    Think about what you want for your business in the next 3-6 months.
                </div>
                <div class="options">
                    <div class="option-card" onclick="selectSingle(this, 'topic-goal')">
                        <h4>Win more customers</h4>
                        <p>Generate leads and close more deals</p>
                    </div>
                    <div class="option-card" onclick="selectSingle(this, 'topic-goal')">
                        <h4>Be seen as the expert</h4>
                        <p>Build thought leadership and credibility in our space</p>
                    </div>
                    <div class="option-card" onclick="selectSingle(this, 'topic-goal')">
                        <h4>Upsell existing customers</h4>
                        <p>Get current customers using more features or upgrading</p>
                    </div>
                    <div class="option-card" onclick="selectSingle(this, 'topic-goal')">
                        <h4>Enter a new market</h4>
                        <p>Reach a new industry or audience we haven't targeted before</p>
                    </div>
                </div>
                <div class="button-group">
                    <button class="btn btn-secondary" onclick="cancelTopicHelp()">Back</button>
                    <button class="btn btn-primary" onclick="nextTopicStep()">Next</button>
                </div>
            </div>

            <div class="step" data-step="topic-2">
                <div class="question">What's happening in your industry right now?</div>
                <div class="helper-text">
                    Select anything that's creating buzz, concern, or change for your customers.
                </div>
                <div class="options" id="industry-trends-options">
                    <div class="checkbox-option" onclick="toggleCheckbox(this)">
                        <input type="checkbox" id="trend-legislation">
                        <div class="label-content">
                            <strong>New laws or regulations</strong>
                            <span>Compliance requirements, legal changes, new standards</span>
                        </div>
                    </div>
                    <div class="checkbox-option" onclick="toggleCheckbox(this)">
                        <input type="checkbox" id="trend-technology">
                        <div class="label-content">
                            <strong>New technology or AI</strong>
                            <span>Industry adopting new tools, automation, or AI solutions</span>
                        </div>
                    </div>
                    <div class="checkbox-option" onclick="toggleCheckbox(this)">
                        <input type="checkbox" id="trend-risk">
                        <div class="label-content">
                            <strong>Increased risk or liability</strong>
                            <span>Companies worried about lawsuits, safety, or reputation damage</span>
                        </div>
                    </div>
                    <div class="checkbox-option" onclick="toggleCheckbox(this)">
                        <input type="checkbox" id="trend-efficiency">
                        <div class="label-content">
                            <strong>Pressure to do more with less</strong>
                            <span>Budget cuts, staffing shortages, need for efficiency</span>
                        </div>
                    </div>
                    <div class="checkbox-option" onclick="toggleCheckbox(this)">
                        <input type="checkbox" id="trend-culture">
                        <div class="label-content">
                            <strong>Workplace culture issues</strong>
                            <span>DEI, harassment, psychological safety, employee wellbeing</span>
                        </div>
                    </div>
                    <div class="checkbox-option" onclick="toggleCheckbox(this)">
                        <input type="checkbox" id="trend-none">
                        <div class="label-content">
                            <strong>Nothing major / Not sure</strong>
                            <span>Industry is fairly stable right now</span>
                        </div>
                    </div>
                </div>
                <div class="button-group">
                    <button class="btn btn-secondary" onclick="prevTopicStep()">Back</button>
                    <button class="btn btn-primary" onclick="generateTopicIdeas()">Generate Topic Ideas</button>
                </div>
            </div>

            <div class="step" data-step="topic-results">
                <div class="question">Here are some webinar topic ideas</div>
                <div class="helper-text">
                    Based on what you told us, here are topics that could work well. Select one or use it as inspiration.
                </div>
                <div id="topic-suggestions" class="options">
                    <!-- AI-generated topics will be inserted here -->
                </div>
                <div class="helper-text" style="margin-top: 25px;">
                    Or write your own topic:
                </div>
                <textarea class="text-input" id="custom-topic" placeholder="Type your own topic idea..."></textarea>
                <div class="button-group">
                    <button class="btn btn-secondary" onclick="prevTopicStep()">Back</button>
                    <button class="btn btn-primary" onclick="useSelectedTopic()">Use This Topic</button>
                </div>
            </div>

            <!-- Step 2: What problem does this solve? -->
            <div class="step" data-step="2">
                <div class="question">Why would someone want to attend?</div>
                <div class="helper-text">
                    Think about the person attending. What problem are they facing? What will they learn or be able to do after attending?
                </div>
                <div class="example-box">
                    <strong>Good examples:</strong><br>
                    • "They're worried about getting sued for mishandling investigations"<br>
                    • "They don't know the new reporting requirements"<br>
                    • "They're overwhelmed with complaints and don't have a system"<br>
                    • "They want to reduce workplace misconduct"
                    <button class="copy-btn" onclick="copyExample(this)">Copy</button>
                </div>
                <textarea class="text-input" id="attendee-benefit" placeholder="What problem does this solve for attendees?"></textarea>
                <div class="button-group">
                    <button class="btn btn-secondary" onclick="prevStep()">Back</button>
                    <button class="btn btn-primary" onclick="nextStep()">Next</button>
                </div>
            </div>

            <!-- Step 3: Who are the actual people you want there? -->
            <div class="step" data-step="3">
                <div class="question">Think of 2-3 real people who should attend this</div>
                <div class="helper-text">
                    Not job titles - actual people. This could be someone at a client, a prospect you've been talking to, someone you met at an event, or someone at a company you want to work with.
                </div>
                <div class="example-box">
                    <strong>Example:</strong>
                    "Sarah from Solotel's HR team - she mentioned they're struggling with investigations. Also the compliance person at CatholicCare who reached out last month. And the HR Director at Lendlease that we've been trying to get a meeting with."
                    <button class="copy-btn" onclick="copyExample(this)">Copy</button>
                </div>
                <textarea class="text-input" id="target-people" placeholder="Describe 2-3 specific people or types of people..."></textarea>

                <div class="helper-text" style="margin-top: 20px;">
                    Now, what do these people have in common? (Their job role or department)
                </div>
                <div class="tip-box">
                    <strong>Tip:</strong> This helps us understand where to find more people like them
                </div>
                <div class="options" id="audience-options">
                    <div class="checkbox-option" onclick="toggleCheckbox(this)">
                        <input type="checkbox" id="aud-legal">
                        <div class="label-content">
                            <strong>Legal / Compliance / Risk</strong>
                            <span>General Counsel, Legal Directors, Compliance Officers, Risk Managers</span>
                        </div>
                    </div>
                    <div class="checkbox-option" onclick="toggleCheckbox(this)">
                        <input type="checkbox" id="aud-hr">
                        <div class="label-content">
                            <strong>People & Culture / HR</strong>
                            <span>HR Directors, People & Culture Leaders, Employee Relations</span>
                        </div>
                    </div>
                    <div class="checkbox-option" onclick="toggleCheckbox(this)">
                        <input type="checkbox" id="aud-safety">
                        <div class="label-content">
                            <strong>Health & Safety / WHS</strong>
                            <span>WHS Managers, Safety Officers, Health & Safety Coordinators</span>
                        </div>
                    </div>
                    <div class="checkbox-option" onclick="toggleCheckbox(this)">
                        <input type="checkbox" id="aud-education">
                        <div class="label-content">
                            <strong>Education Integrity / Student Conduct</strong>
                            <span>Academic Integrity Officers, Student Conduct Coordinators</span>
                        </div>
                    </div>
                    <div class="checkbox-option" onclick="toggleCheckbox(this)">
                        <input type="checkbox" id="aud-social">
                        <div class="label-content">
                            <strong>Social Services / Safeguarding</strong>
                            <span>Safeguarding Leads, Child Protection, Community Services</span>
                        </div>
                    </div>
                    <div class="checkbox-option" onclick="toggleCheckbox(this)">
                        <input type="checkbox" id="aud-leadership">
                        <div class="label-content">
                            <strong>Senior Leadership</strong>
                            <span>CEOs, COOs, General Managers who care about risk and culture</span>
                        </div>
                    </div>
                </div>

                <div class="button-group">
                    <button class="btn btn-secondary" onclick="prevStep()">Back</button>
                    <button class="btn btn-primary" onclick="nextStep()">Next</button>
                </div>
            </div>

            <!-- Step 4: What do you want them to do? -->
            <div class="step" data-step="4">
                <div class="question">After someone hears about this, what should they do?</div>
                <div class="helper-text">
                    Be specific. What's the one action you want them to take?
                </div>
                <div class="options">
                    <div class="option-card" onclick="selectSingle(this, 'action')">
                        <h4>Register for the webinar</h4>
                        <p>Sign up to attend the event</p>
                    </div>
                    <div class="option-card" onclick="selectSingle(this, 'action')">
                        <h4>Book a demo of our product</h4>
                        <p>Schedule a one-on-one product demonstration</p>
                    </div>
                    <div class="option-card" onclick="selectSingle(this, 'action')">
                        <h4>Schedule a conversation</h4>
                        <p>Book a call to discuss their specific needs</p>
                    </div>
                    <div class="option-card" onclick="selectSingle(this, 'action')">
                        <h4>Download a guide or resource</h4>
                        <p>Get a helpful document or tool</p>
                    </div>
                </div>

                <div class="helper-text" style="margin-top: 20px;">
                    And what's your ultimate goal from all of this?
                </div>
                <div class="options">
                    <div class="option-card" onclick="selectSingle(this, 'goal')">
                        <h4>Get sales meetings booked</h4>
                        <p>I want people ready to buy</p>
                    </div>
                    <div class="option-card" onclick="selectSingle(this, 'goal')">
                        <h4>Build our reputation</h4>
                        <p>I want to be seen as an expert in the space</p>
                    </div>
                    <div class="option-card" onclick="selectSingle(this, 'goal')">
                        <h4>Collect contacts for later</h4>
                        <p>Build a list to nurture over time</p>
                    </div>
                    <div class="option-card" onclick="selectSingle(this, 'goal')">
                        <h4>Strengthen partner relationships</h4>
                        <p>Deepen connections with the co-hosts and partners</p>
                    </div>
                </div>

                <div class="button-group">
                    <button class="btn btn-secondary" onclick="prevStep()">Back</button>
                    <button class="btn btn-primary" onclick="nextStep()">Next</button>
                </div>
            </div>

            <!-- Step 5: What can you actually do? -->
            <div class="step" data-step="5">
                <div class="question">What can you actually commit to doing?</div>
                <div class="helper-text">
                    Be honest about time and resources. It's better to do 2 things well than 10 things poorly.
                </div>
                <div class="options" id="capability-options">
                    <div class="checkbox-option" onclick="toggleCheckbox(this)">
                        <input type="checkbox" id="cap-email">
                        <div class="label-content">
                            <strong>Send emails to our list</strong>
                            <span>We have a list and can send promotional emails</span>
                        </div>
                    </div>
                    <div class="checkbox-option" onclick="toggleCheckbox(this)">
                        <input type="checkbox" id="cap-personal">
                        <div class="label-content">
                            <strong>Personal outreach (1-on-1 messages)</strong>
                            <span>We can spend 3-5 hours messaging specific people individually</span>
                        </div>
                    </div>
                    <div class="checkbox-option" onclick="toggleCheckbox(this)">
                        <input type="checkbox" id="cap-linkedin-posts">
                        <div class="label-content">
                            <strong>Post on LinkedIn and social media</strong>
                            <span>We can create and share posts organically</span>
                        </div>
                    </div>
                    <div class="checkbox-option" onclick="toggleCheckbox(this)">
                        <input type="checkbox" id="cap-paid-ads">
                        <div class="label-content">
                            <strong>Run paid ads ($2,000+ budget)</strong>
                            <span>We have budget for LinkedIn or other paid advertising</span>
                        </div>
                    </div>
                    <div class="checkbox-option" onclick="toggleCheckbox(this)">
                        <input type="checkbox" id="cap-content">
                        <div class="label-content">
                            <strong>Create content (landing page, graphics, etc.)</strong>
                            <span>We can build promotional materials and web pages</span>
                        </div>
                    </div>
                    <div class="checkbox-option" onclick="toggleCheckbox(this)">
                        <input type="checkbox" id="cap-partner-promo">
                        <div class="label-content">
                            <strong>Get partners to promote it</strong>
                            <span>Our partners and co-hosts will help spread the word to their audiences</span>
                        </div>
                    </div>
                </div>

                <div class="button-group">
                    <button class="btn btn-secondary" onclick="prevStep()">Back</button>
                    <button class="btn btn-primary" onclick="nextStep()">Next</button>
                </div>
            </div>

            <!-- Step 6: Timeline and context -->
            <div class="step" data-step="6">
                <div class="question">When is this happening?</div>
                <div class="helper-text">
                    When is the webinar or event taking place?
                </div>
                <input type="date" class="text-input" id="timeline">

                <div class="helper-text" style="margin-top: 20px;">
                    What's worked before? What hasn't?
                </div>
                <div class="example-box">
                    <strong>Example:</strong>
                    "Last webinar we got 40 registrations from email. LinkedIn posts got zero. Our partner sent it to their list and we got 15 from that."
                    <button class="copy-btn" onclick="copyExample(this)">Copy</button>
                </div>
                <textarea class="text-input" id="past-experience" placeholder="Share any past marketing wins or failures (optional but helpful)..."></textarea>

                <div class="helper-text">
                    Anything else we should know?
                </div>
                <div class="example-box">
                    <strong>Example:</strong>
                    "Tight timeline - only 2 weeks to promote. Limited budget. Need partner approval on messaging."
                    <button class="copy-btn" onclick="copyExample(this)">Copy</button>
                </div>
                <textarea class="text-input" id="constraints" placeholder="Any constraints, concerns, or special requirements? (optional)"></textarea>

                <div class="button-group">
                    <button class="btn btn-secondary" onclick="prevStep()">Back</button>
                    <button class="btn btn-primary" onclick="generateStrategy()">Generate My Marketing Plan</button>
                </div>
            </div>

            <!-- Loading State -->
            <div class="loading" id="loading">
                <div class="spinner"></div>
                <p style="font-size: 1.2em; font-weight: 500; color: #2d5f4f;">Creating your marketing strategy...</p>
                <p style="color: #5a6c62; font-size: 0.95em; margin-top: 10px;">
                    We're analyzing your answers and building a personalized plan<br>
                    This takes about 15-20 seconds
                </p>
            </div>

            <!-- Results -->
            <div class="results" id="results">
                <h2>Your Marketing Strategy</h2>
                <div id="strategy-content">
                    <!-- Strategy will be inserted here by AI -->
                </div>
                <div class="export-buttons">
                    <button class="btn btn-secondary" onclick="saveCampaign()">Save Campaign</button>
                    <button class="btn btn-secondary" onclick="loadCampaign()">Load Saved Campaign</button>
                    <button class="btn btn-secondary" onclick="downloadPDF()">Download PDF</button>
                    <button class="btn btn-secondary" onclick="copyToClipboard()">Copy to Clipboard</button>
                    <button class="btn btn-primary" onclick="startOver()">Create Another Strategy</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        let currentStep = 1;
        const totalSteps = 6;
        const selections = {
            companyBackground: "Elker is a workplace reporting and case management platform that enables employees to anonymously report concerns about misconduct, safety issues, and other workplace problems. We help organizations transform from reactive (responding to known incidents) to proactive (identifying emerging risks early through employee feedback). Our platform combines anonymous reporting, efficient case management, and real-time analytics. We serve HR teams, legal departments, compliance officers, WHS managers, and integrity teams across businesses, universities, schools, government agencies, and aged care providers."
        };
        let inTopicMode = false;

        function updateProgress() {
            const progress = (currentStep / totalSteps) * 100;
            document.getElementById('progressBar').style.width = progress + '%';
        }

        function nextStep() {
            if (!validateStep(currentStep)) {
                return;
            }

            saveStepData(currentStep);

            document.querySelector(`.step[data-step="${currentStep}"]`).classList.remove('active');
            currentStep++;
            document.querySelector(`.step[data-step="${currentStep}"]`).classList.add('active');
            updateProgress();

            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        function prevStep() {
            document.querySelector(`.step[data-step="${currentStep}"]`).classList.remove('active');
            currentStep--;
            document.querySelector(`.step[data-step="${currentStep}"]`).classList.add('active');
            updateProgress();
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        function validateStep(step) {
            switch(step) {
                case 1:
                    const topic = document.getElementById('topic').value.trim();
                    if (!topic) {
                        alert('Please describe your webinar topic or click "Help me think of a topic"');
                        return false;
                    }
                    return true;
                case 2:
                    const benefit = document.getElementById('attendee-benefit').value.trim();
                    if (!benefit) {
                        alert('Please explain why someone would want to attend');
                        return false;
                    }
                    return true;
                case 3:
                    const people = document.getElementById('target-people').value.trim();
                    if (!people) {
                        alert('Please describe 2-3 people you want to attend');
                        return false;
                    }
                    const selectedAudiences = document.querySelectorAll('#audience-options .checkbox-option.selected');
                    if (selectedAudiences.length === 0) {
                        alert('Please select at least one job role/department that matches your target people');
                        return false;
                    }
                    return true;
                case 4:
                    if (!document.querySelector('.option-card.selected[data-group="action"]')) {
                        alert('Please select what action you want people to take');
                        return false;
                    }
                    if (!document.querySelector('.option-card.selected[data-group="goal"]')) {
                        alert('Please select your ultimate goal');
                        return false;
                    }
                    return true;
                case 5:
                    const capabilities = document.querySelectorAll('#capability-options .checkbox-option.selected');
                    if (capabilities.length === 0) {
                        alert('Please select at least one thing you can commit to doing');
                        return false;
                    }
                    return true;
                case 6:
                    const timeline = document.getElementById('timeline').value;
                    if (!timeline) {
                        alert('Please select when your event is happening');
                        return false;
                    }
                    return true;
                default:
                    return true;
            }
        }

        function saveStepData(step) {
            switch(step) {
                case 1:
                    selections.topic = document.getElementById('topic').value.trim();
                    selections.partners = document.getElementById('partners').value.trim();
                    break;
                case 2:
                    selections.attendeeBenefit = document.getElementById('attendee-benefit').value.trim();
                    break;
                case 3:
                    selections.targetPeople = document.getElementById('target-people').value.trim();
                    selections.audiences = Array.from(document.querySelectorAll('#audience-options .checkbox-option.selected'))
                        .map(el => ({
                            role: el.querySelector('strong').textContent,
                            description: el.querySelector('span').textContent
                        }));
                    break;
                case 4:
                    selections.action = document.querySelector('.option-card.selected[data-group="action"]')?.querySelector('h4').textContent;
                    selections.goal = document.querySelector('.option-card.selected[data-group="goal"]')?.querySelector('h4').textContent;
                    break;
                case 5:
                    selections.capabilities = Array.from(document.querySelectorAll('#capability-options .checkbox-option.selected'))
                        .map(el => ({
                            capability: el.querySelector('strong').textContent,
                            description: el.querySelector('span').textContent
                        }));
                    break;
                case 6:
                    selections.timeline = document.getElementById('timeline').value;
                    selections.pastExperience = document.getElementById('past-experience').value.trim();
                    selections.constraints = document.getElementById('constraints').value.trim();
                    break;
            }
        }

        function selectSingle(element, group) {
            document.querySelectorAll(`.option-card[data-group="${group}"]`).forEach(card => {
                card.classList.remove('selected');
            });

            element.classList.add('selected');
            element.setAttribute('data-group', group);
        }

        function toggleCheckbox(element) {
            const checkbox = element.querySelector('input[type="checkbox"]');

            checkbox.checked = !checkbox.checked;
            element.classList.toggle('selected', checkbox.checked);

            // Handle "nothing major/not sure" in industry trends
            if (checkbox.id === 'trend-none' && element.closest('#industry-trends-options')) {
                if (!checkbox.checked) {
                    document.querySelectorAll('#industry-trends-options .checkbox-option').forEach(opt => {
                        if (opt !== element) {
                            opt.querySelector('input').checked = false;
                            opt.classList.remove('selected');
                        }
                    });
                }
            } else if (element.closest('#industry-trends-options') && checkbox.id !== 'trend-none') {
                const noneOption = document.getElementById('trend-none');
                if (noneOption && noneOption.checked) {
                    noneOption.checked = false;
                    noneOption.closest('.checkbox-option').classList.remove('selected');
                }
            }
        }

        // Copy example text function
        function copyExample(button) {
            const exampleBox = button.closest('.example-box');
            const textToCopy = exampleBox.innerText.replace('EXAMPLE:', '').replace('Copy', '').trim();

            navigator.clipboard.writeText(textToCopy).then(() => {
                const originalText = button.textContent;
                button.textContent = 'Copied!';
                setTimeout(() => {
                    button.textContent = originalText;
                }, 2000);
            });
        }

        // Topic ideation flow functions
        function helpWithTopic() {
            // Hide step 1, show topic-1
            document.querySelector('.step[data-step="1"]').classList.remove('active');
            document.querySelector('.step[data-step="topic-1"]').classList.add('active');
            inTopicMode = true;
        }

        function cancelTopicHelp() {
            document.querySelector('.step[data-step="topic-1"]').classList.remove('active');
            document.querySelector('.step[data-step="1"]').classList.add('active');
            inTopicMode = false;
        }

        function nextTopicStep() {
            // Validate topic-goal is selected
            if (!document.querySelector('.option-card.selected[data-group="topic-goal"]')) {
                alert('Please select a business goal');
                return;
            }

            document.querySelector('.step[data-step="topic-1"]').classList.remove('active');
            document.querySelector('.step[data-step="topic-2"]').classList.add('active');
        }

        function prevTopicStep() {
            const currentTopicStep = document.querySelector('.step.active');
            const stepAttr = currentTopicStep.getAttribute('data-step');

            if (stepAttr === 'topic-2') {
                document.querySelector('.step[data-step="topic-2"]').classList.remove('active');
                document.querySelector('.step[data-step="topic-1"]').classList.add('active');
            } else if (stepAttr === 'topic-results') {
                document.querySelector('.step[data-step="topic-results"]').classList.remove('active');
                document.querySelector('.step[data-step="topic-2"]').classList.add('active');
            }
        }

        async function generateTopicIdeas() {
            // Validate at least one trend is selected
            const selectedTrends = document.querySelectorAll('#industry-trends-options .checkbox-option.selected');
            if (selectedTrends.length === 0) {
                alert('Please select at least one industry trend');
                return;
            }

            // Hide current step, show loading
            document.querySelector('.step[data-step="topic-2"]').classList.remove('active');
            document.getElementById('loading').classList.add('active');

            try {
                const topics = await callClaudeForTopics();
                displayTopicSuggestions(topics);
            } catch (error) {
                console.error('Error generating topics:', error);
                alert('Error generating topic ideas: ' + error.message);
                document.getElementById('loading').classList.remove('active');
                document.querySelector('.step[data-step="topic-2"]').classList.add('active');
            }
        }

        async function callClaudeForTopics() {
            const topicGoal = document.querySelector('.option-card.selected[data-group="topic-goal"]')?.querySelector('h4').textContent;
            const trends = Array.from(document.querySelectorAll('#industry-trends-options .checkbox-option.selected'))
                .map(el => el.querySelector('strong').textContent);

            const prompt = `You are helping a company brainstorm webinar topics.

COMPANY CONTEXT:
${selections.companyBackground}

BUSINESS GOAL:
${topicGoal}

INDUSTRY TRENDS/ISSUES:
${trends.join(', ')}

Generate 4 specific, compelling webinar topic ideas that:
1. Align with their business goal
2. Address the industry trends they selected
3. Would appeal to their potential customers (based on company context)
4. Are specific enough to be actionable (not generic like "How to improve X")

For each topic, provide:
- A clear, compelling title (8-12 words)
- A brief description of what the webinar would cover (2-3 sentences)
- Why this topic matters right now

Format as HTML with this structure for each topic:
<div class="option-card topic-suggestion" onclick="selectSingle(this, 'suggested-topic')">
    <h4>[Topic Title]</h4>
    <p><strong>What it covers:</strong> [Description]</p>
    <p><strong>Why now:</strong> [Relevance]</p>
</div>

Return ONLY the HTML divs, no other text.`;

            const response = await fetch('/api/generate-strategy', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({
                    prompt: prompt,
                    maxTokens: 2000
                })
            });

            if (!response.ok) {
                const error = await response.json();
                throw new Error(error.error || 'Failed to generate topics');
            }

            const data = await response.json();
            return data.content;
        }

        function displayTopicSuggestions(htmlContent) {
            document.getElementById('loading').classList.remove('active');
            document.getElementById('topic-suggestions').innerHTML = htmlContent;
            document.querySelector('.step[data-step="topic-results"]').classList.add('active');
        }

        function useSelectedTopic() {
            const selectedTopic = document.querySelector('.topic-suggestion.selected');
            const customTopic = document.getElementById('custom-topic').value.trim();

            let finalTopic = '';

            if (selectedTopic) {
                finalTopic = selectedTopic.querySelector('h4').textContent;
            } else if (customTopic) {
                finalTopic = customTopic;
            } else {
                alert('Please select a suggested topic or write your own');
                return;
            }

            // Set the topic in step 1
            document.getElementById('topic').value = finalTopic;

            // Hide topic results, show step 1
            document.querySelector('.step[data-step="topic-results"]').classList.remove('active');
            document.querySelector('.step[data-step="1"]').classList.add('active');
            inTopicMode = false;
        }

        async function generateStrategy() {
            if (!validateStep(6)) {
                return;
            }
            saveStepData(6);

            // Hide current step
            document.querySelector(`.step[data-step="${currentStep}"]`).classList.remove('active');

            // Show loading
            document.getElementById('loading').classList.add('active');

            try {
                const strategy = await callClaudeAPI(selections);
                displayStrategy(strategy);
            } catch (error) {
                console.error('Error generating strategy:', error);
                alert('Error generating strategy: ' + error.message);
                document.getElementById('loading').classList.remove('active');
                document.querySelector(`.step[data-step="${currentStep}"]`).classList.add('active');
            }
        }

        async function callClaudeAPI(selections) {
            const prompt = buildPrompt(selections);

            const response = await fetch('/api/generate-strategy', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({
                    prompt: prompt,
                    maxTokens: 4096
                })
            });

            if (!response.ok) {
                const error = await response.json();
                throw new Error(error.error || 'Failed to generate strategy');
            }

            const data = await response.json();
            return data.content;
        }

        function buildPrompt(sel) {
            const eventDate = new Date(sel.timeline);
            const today = new Date();
            const daysUntil = Math.ceil((eventDate - today) / (1000 * 60 * 60 * 24));

            return `You are a marketing strategist helping someone plan their webinar or event promotion. They've answered questions as a complete novice, so your strategy needs to be specific, actionable, and assume zero marketing knowledge.

CONTEXT GATHERED:

**Company background:**
${sel.companyBackground}

**What they're promoting:**
Topic: ${sel.topic}
${sel.partners ? 'Partners involved: ' + sel.partners : 'No partners'}

**Why someone would attend (the value proposition):**
${sel.attendeeBenefit}

**Who they want to reach:**
Specific people in mind: ${sel.targetPeople}
Job roles and departments: ${sel.audiences.map(a => a.role).join(', ')}

**Desired action:** ${sel.action}
**Ultimate goal:** ${sel.goal}

**What they can actually do (capabilities):**
${sel.capabilities.map(c => c.capability).join(', ')}

**Timeline:**
Event date: ${sel.timeline} (${daysUntil} days from now)

**Past experience:**
${sel.pastExperience || 'No past data provided'}

**Constraints and concerns:**
${sel.constraints || 'None mentioned'}

---

Create a marketing strategy that:

1. **AUDIENCE SEGMENTATION STRATEGY** - Start by explaining WHY segmentation matters for this specific topic and audiences.
   - Which Elker client segments are most relevant (workplaces, universities, schools, government, aged care, social services)
   - Why this topic will resonate differently with each segment
   - Specific pain points or interests for each segment
   - How to identify these segments in their CRM

   Be educational - explain the strategic thinking behind the segmentation so they understand the "why" not just the "what".

2. **CONTENT & MESSAGING STRATEGY** - This is the most important section. Provide deep, specific guidance:

   For EACH target audience segment, provide:
   - **Why this content will resonate**: Explain the specific pain points, interests, or goals this segment has
   - **Messaging angle**: What specific angle/framing will work best for this audience (e.g., compliance focus for legal teams, ROI focus for executives)
   - **Content examples**: 3-4 specific content ideas/templates tailored to this segment:
     * Email subject lines with explanation of why they work
     * Email body copy (2-3 paragraph template)
     * LinkedIn post variations
     * Specific call-to-action options and why each works
   - **Language & tone guidance**: What words, phrases, or tone resonates with this segment

   Wrap all copyable templates in <div class="ai-content"> with copy buttons. Provide strategic explanation in regular <p> tags.

3. **CHANNEL-SPECIFIC TACTICS** - For each channel they can use (based on capabilities):
   - Specific tactic (not just "use email" but "send 3 emails: save-the-date, reminder, last-chance")
   - When to execute (specific days relative to event)
   - Template or example (wrap in ai-content div with copy button)
   - Expected outcome (realistic numbers)

4. **POST-EVENT FOLLOW-UP STRATEGY** - Critical for achieving their campaign goals. Provide a detailed plan:
   - Segmented follow-up based on engagement (attended vs. registered but didn't attend vs. didn't register)
   - Specific follow-up content for each segment (wrap templates in ai-content divs)
   - Timeline for follow-ups (day 1, day 3, day 7, day 14)
   - How to move attendees toward their ultimate goal (${sel.goal})
   - Nurture sequence ideas to keep the conversation going

   Explain WHY each follow-up matters and what it accomplishes toward their goal.

5. **QUICK TIMELINE & KEY ACTIONS** - Keep this concise. Just the critical milestones:
   - Week 1: [Top 2 actions]
   - Week 2: [Top 2 actions]
   - Week 3+: [Top 2 actions]
   - Day before event: [Final checklist]

   Focus only on the most important actions, not exhaustive lists.

6. **RECOMMENDED SUCCESS METRICS** - Based on their target audience and capabilities, what numbers should they expect? Give ranges (conservative to optimistic).

   IMPORTANT: Frame email metrics as "ideal reach" or "potential reach" rather than assuming list size. Provide guidance like:
   - Small/niche topics: Aim to reach 50-200 relevant contacts across email, LinkedIn, and direct outreach
   - Medium scope: Aim to reach 200-500 relevant contacts
   - Broad appeal: Aim to reach 500-800+ relevant contacts

   Focus on TOTAL REACH across all channels (email + LinkedIn + direct outreach + partners) rather than assuming a specific email database size. Let them determine how to achieve that reach based on their available contacts and capabilities.

7. **NEXT 3 ACTIONS** - What are the literal next 3 things they should do today? Be incredibly specific.

**IMPORTANT STYLE NOTES:**
- Write in a professional, consultative tone (not salesy or alarmist)
- Use "you" language
- No jargon - if you must use marketing terms, explain them
- Give examples for everything
- When suggesting email or social content, write actual templates they can copy
- Focus on targeted outreach to the specific audiences they identified
- If they have partners, emphasize leveraging partner credibility and lists
- Be honest and realistic about what will and won't work given their constraints

**CRITICAL EMAIL SEGMENTATION GUIDANCE:**
Elker works with diverse client types: workplaces/businesses, universities, schools, government agencies, aged care providers, and social services organizations.

For email campaigns, you MUST provide specific segmentation advice:
1. Analyze the webinar topic and target audiences they selected
2. Determine which client segments are most relevant (e.g., if topic is about student misconduct, focus on universities/schools; if about workplace investigations, focus on businesses/government)
3. Provide clear segmentation criteria, such as:
   - "Email contacts tagged as 'Higher Education' OR 'Schools' in your CRM"
   - "Email HR and Legal contacts from Business and Government client segments"
   - "Email all contacts from Healthcare and Aged Care organizations"
4. If the topic is broadly relevant across ALL Elker client types, you MAY recommend emailing the full database, but explain WHY it's appropriate and suggest personalizing by segment
5. Always specify: "Segment your CRM by [criteria] and only email those matching [description]"

Never just say "email your list" - always provide the segmentation logic based on topic relevance.

**FORMAT:**
Return as clean HTML using ACCORDION SECTIONS for each major section (1-7 above):

Structure each section like this:
<div class="accordion-section">
  <div class="accordion-header" onclick="toggleAccordion(this)">
    <h3>Section Title</h3>
    <span class="accordion-icon">▼</span>
  </div>
  <div class="accordion-content">
    <!-- Section content here -->
  </div>
</div>

Within accordion content, use these classes:
- <div class="recommendation-box"> for sub-sections (NO copy buttons on these)
- <div class="metric-badge priority-high/medium/low"> for priorities and metrics
- <ul> and <li> for action lists (NO copy buttons)
- <div class="ai-content"> for ACTUAL MESSAGE TEMPLATES ONLY (email subject lines, social post copy, outreach messages) - add <button class="copy-btn" onclick="copyAIContent(this)">Copy</button> inside these
- <strong> for emphasis
- <p> for explanatory text (NO copy buttons)

**CRITICAL FORMATTING REQUIREMENTS:**
- ALWAYS wrap each paragraph of explanatory text in <p> tags
- Do NOT use <br> tags for line breaks between paragraphs
- Each distinct paragraph should be wrapped in its own <p></p> tags
- Use double line breaks (blank lines) between sections for better readability
- Inside .ai-content divs, use <p> tags for each line/paragraph of the message template

Only add copy buttons to actual copyable message templates (email subjects, social posts, outreach messages). Do NOT add copy buttons to instructions, recommendations, or explanatory text.

Make this incredibly practical and targeted. They should be able to read this and immediately know what to do next.`;
        }

        function displayStrategy(htmlContent) {
            document.getElementById('loading').classList.remove('active');
            document.getElementById('strategy-content').innerHTML = htmlContent;
            document.getElementById('results').classList.add('active');
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        function copyToClipboard() {
            const content = document.getElementById('strategy-content').innerText;
            navigator.clipboard.writeText(content).then(() => {
                alert('Strategy copied to clipboard!');
            });
        }

        function copyRecommendation(button) {
            const box = button.closest('.recommendation-box');
            const textToCopy = box.innerText.replace('Copy', '').trim();

            navigator.clipboard.writeText(textToCopy).then(() => {
                const originalText = button.textContent;
                button.textContent = 'Copied!';
                setTimeout(() => {
                    button.textContent = originalText;
                }, 2000);
            });
        }

        function copyAIContent(button) {
            const content = button.closest('.ai-content');
            const textToCopy = content.innerText.replace('Copy', '').trim();

            navigator.clipboard.writeText(textToCopy).then(() => {
                const originalText = button.textContent;
                button.textContent = 'Copied!';
                setTimeout(() => {
                    button.textContent = originalText;
                }, 2000);
            });
        }

        function toggleAccordion(header) {
            const section = header.parentElement;
            section.classList.toggle('collapsed');
        }

        function saveCampaign() {
            const campaignName = prompt('Enter a name for this campaign:');
            if (!campaignName) return;

            const campaign = {
                name: campaignName,
                date: new Date().toISOString(),
                selections: selections,
                strategy: document.getElementById('strategy-content').innerHTML
            };

            // Get existing campaigns
            const campaigns = JSON.parse(localStorage.getItem('elkerCampaigns') || '[]');
            campaigns.push(campaign);
            localStorage.setItem('elkerCampaigns', JSON.stringify(campaigns));

            alert(`Campaign "${campaignName}" saved successfully!`);
        }

        function loadCampaign() {
            const campaigns = JSON.parse(localStorage.getItem('elkerCampaigns') || '[]');

            if (campaigns.length === 0) {
                alert('No saved campaigns found.');
                return;
            }

            // Create a selection modal
            let options = campaigns.map((c, i) =>
                `${i + 1}. ${c.name} (${new Date(c.date).toLocaleDateString()})`
            ).join('\n');

            const choice = prompt(`Select a campaign to load:\n\n${options}\n\nEnter the number (or "delete" to manage campaigns):`);

            if (!choice) return;

            if (choice.toLowerCase() === 'delete') {
                manageCampaigns(campaigns);
                return;
            }

            const index = parseInt(choice) - 1;
            if (index >= 0 && index < campaigns.length) {
                const campaign = campaigns[index];
                document.getElementById('strategy-content').innerHTML = campaign.strategy;
                document.getElementById('results').classList.add('active');
                window.scrollTo({ top: 0, behavior: 'smooth' });
                alert(`Campaign "${campaign.name}" loaded successfully!`);
            } else {
                alert('Invalid selection.');
            }
        }

        function manageCampaigns(campaigns) {
            let options = campaigns.map((c, i) =>
                `${i + 1}. ${c.name} (${new Date(c.date).toLocaleDateString()})`
            ).join('\n');

            const choice = prompt(`Delete a campaign:\n\n${options}\n\nEnter the number to delete (or cancel):`);
            if (!choice) return;

            const index = parseInt(choice) - 1;
            if (index >= 0 && index < campaigns.length) {
                const deleted = campaigns.splice(index, 1)[0];
                localStorage.setItem('elkerCampaigns', JSON.stringify(campaigns));
                alert(`Campaign "${deleted.name}" deleted.`);
                loadCampaign();
            }
        }

        function downloadPDF() {
            // Create a clean version for PDF
            const content = document.getElementById('strategy-content').cloneNode(true);

            // Remove copy buttons
            content.querySelectorAll('.copy-btn').forEach(btn => btn.remove());

            // Open accordions for PDF
            content.querySelectorAll('.accordion-section').forEach(section => {
                section.classList.remove('collapsed');
            });

            // Create printable HTML
            const printWindow = window.open('', '', 'height=800,width=800');
            printWindow.document.write(`
                <html>
                <head>
                    <title>Marketing Strategy</title>
                    <style>
                        body {
                            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
                            line-height: 1.6;
                            color: #2c3e50;
                            padding: 40px;
                            max-width: 800px;
                            margin: 0 auto;
                        }
                        h2 { color: #2d5f4f; font-family: Georgia, serif; margin-top: 30px; }
                        h3 { color: #2d5f4f; font-family: Georgia, serif; margin-top: 25px; }
                        .accordion-header { display: none; }
                        .accordion-content { padding: 0; display: block !important; }
                        .accordion-section { border: 1px solid #d4e0d8; margin-bottom: 20px; padding: 20px; }
                        .recommendation-box { background: #f9faf9; padding: 20px; margin: 15px 0; border: 1px solid #d4e0d8; }
                        .ai-content { background: white; padding: 15px; border: 1px solid #d4e0d8; margin: 10px 0; }
                        ul { padding-left: 20px; }
                        li { margin: 8px 0; }
                        strong { color: #2d5f4f; }
                        p { margin-bottom: 15px; }
                    </style>
                </head>
                <body>
                    <h1>Elker Marketing Strategy</h1>
                    ${content.innerHTML}
                </body>
                </html>
            `);
            printWindow.document.close();
            printWindow.focus();
            setTimeout(() => {
                printWindow.print();
            }, 250);
        }

        function startOver() {
            if (confirm('Start over? This will clear your current strategy.')) {
                location.reload();
            }
        }

        // Initialize
        updateProgress();
    </script>
</body>
</html>
